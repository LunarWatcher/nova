Import("env")

sources = []
sources += env.Glob("nova/*.cpp")
sources += env.Glob("nova/driver/*.cpp")
sources += env.Glob("nova/input/*.cpp")
sources += env.Glob("nova/loading/*.cpp")

sources += env.Glob("nova/modules/*.cpp")
sources += env.Glob("nova/modules/builtins/*.cpp")

env.appendSourcePath("#TermUtils/include/")
env.appendSourcePath("#src/")
env.appendSourcePath("#include/")

if not env.isMSVC():
    env.Append(LINKFLAGS=["-rdynamic"])
    env.Append(LINKFLAGS=["-Wl,-z,origin", """-Wl,-rpath=\$$ORIGIN"""])
    # Explicitly linking dl might be required?
    env.withLibraries("dl")

env.Program("nova", sources)
